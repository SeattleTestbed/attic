"""
  This program runs as a client that sends a message 
  to a server using the reliable_sendmess function from 
  the reliable library.  This client tests the library for 
  user-defined configurations.
  
  It prints an affirmative message if everything went correctly.  
  Otherwise it prints the error that occurred.
  
  This program must be started after the server program is started.


  Arguments needed:
	serverip - the dot-decimal notation ip address of the server
	port - the port number of the server computer

"""



include reliable.repy


if callfunc == 'initialize':

  if len(callargs) != 2 :
    print 'Wrong number of call args used.  The test could not be run.'
    return

  #gets the ip address of the server and the port number
  serverip = callargs[0]
  port = int(callargs[1])

  #make message to be sent
  data = "Testing stop_and_wait TimeoutException"
  print 'message being sent:  ' + data
 
  try:
    #set configurations
    max_dgram_size = 30
    max_retries = 3
    max_timeout = 20
    reliable_config(max_dgram_size, max_retries, max_timeout)

    #send message
    reliable_sendmess(serverip, port, data)
 
  except TimeoutError, e:
    print "test completed"

  exitall()